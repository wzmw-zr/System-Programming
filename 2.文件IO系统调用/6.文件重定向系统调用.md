# `dup2()，dup()`文件重定向系统调用

`dup()`系统调用用来**复制一个文件描述符，即产生一个新的文件描述符使其指向指定文件。**

`dup2()`系统调用用来**将新文件描述符指向一个文件描述符，以此完成重定向功能。**



## 一、`dup()`—复制文件描述符

`dup()`系统调用用来复制文件描述符，即产生一个新的文件描述符指向指定文件。

**==显然：不同文件描述符可以指向同一个文件，同一个文件可以有多个文件描述符。==**

另外，文件描述符的范围是局限于单个进程中的，这一点看可以从多个进程的0,1,2默认的文件描述符可以看出。

`dup()`系统调用的函数原型如下：

```c
#include <unistd.h>

int dup(int fildes);
// return the new fd on success, or -1 on error
```



## 二、`dup2()`—重定向文件描述符(拷贝文件描述符)

`dup2()`系统调用用来重定向一个文件描述符，**`dup2()`系统调用用于将旧的文件描述符重定向到新的文件描述符上。**

举个例子，实现管道的时候，肯定需要重定向，当我们需要标准输出作用于管道时，就需要将标准输出重定向到管道的写端，这样一个命令的结果默认是按照标准输出进行写输出，就转变为了命令的执行结果写输出到管道的写端中。

`dup2()`系统调用的函数原型如下：

```c
#include <unistd.h>
// dup2新建指定文件描述符，如果该文件描述符已经打开，那么就会先关闭，然后将old_fd拷贝到new_fd上，即将旧的文件描述符
// 如果fnew_fd是一个已经打开的文件，那么就会关闭该文件描述符，然后在进行重定向
int dup2(int old_fd, int new_fd);
// return fildes2 on success, or -1 on error
```

**关于如何填写`dup2()`中的文件描述符，==只需记住，第一步需要被关闭原先功能的文件描述符放在后面。==**