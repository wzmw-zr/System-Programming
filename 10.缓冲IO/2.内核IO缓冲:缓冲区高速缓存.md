# 内核IO缓冲

## 一、内核缓冲区的意义

**read()和write()系统调用在操作磁盘文件时==不会直接发起磁盘访问==，而是==仅仅在用户空间缓冲区与内核缓冲区高速缓存(kernel buffer cache)之间复制数据==。**

**内核缓冲区**虽然使得系统调用和磁盘操作不同步，但是使得read和write调用的操作更加快速，因为它们**不需要等待磁盘操作，并且==减少了内核必须执行的磁盘传输次数==。**

**不过需要注意，内核缓冲区减少了内核必须执行的磁盘传输次数，但是==数据的传输总量没有变，这意味着磁盘操作的数量是相同的，不论缓冲区的大小。==**



## 二、缓冲区大小对IO系统调用性能的影响

**Linux内核对==缓冲区高速缓存的大小没有固定上限，内核会分配尽可能多的缓冲区高速缓存页==**，而仅受限于两个因素：可用物理内存总量，出于其他目的对于物理内存的需求。

由于内核缓冲区的大小没有固定上限，在现在的条件下，**基本可以认为用户空间的缓冲区大小就是内核缓冲区的大小，也可以更大，不过这就是内核的事情了。**从`dd`命令可以看出，**如果与文件发生大量的数据传输，通过采用大块的空间缓冲数据，以及执行更少的系统调用，可以极大地提高IO性能。**

